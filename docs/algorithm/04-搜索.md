# æœç´¢

## DFS

ä¸€èˆ¬å’Œæ ˆå’Œé€’å½’è”ç³»èµ·æ¥

æ·±åº¦ä¼˜å…ˆéå†ï¼Œå³ä¼˜å…ˆå‘æ ‘åº•éå†ï¼Œèµ°ä¸€æ¡è·¯çš„åº•éƒ¨ï¼Œå†è¿”å›èµ°å…¶ä»–åˆ†æ”¯ï¼Œé‡å¤æ­¥éª¤ç›´åˆ°éå†å…¨éƒ¨èŠ‚ç‚¹

æœ¬è´¨ä¸Šæ˜¯ä¸€ç§æš´åŠ›çš„éå†æ–¹å¼ï¼Œå®ç°å®ƒä¸éš¾ï¼Œéš¾åœ¨ä¼˜åŒ–

### é˜¶ä¹˜

### æ–æ³¢é‚£å¥‘

### æ ‘éå†

#### æ ‘çš„é‡å¿ƒ

[Acwing846.æ ‘çš„é‡å¿ƒ](https://www.acwing.com/problem/content/description/848/)

åªè¦ç©·ä¸¾æ¯”è¾ƒæ¯ä¸€ä¸ªç‚¹çš„æœ€å¤§å­æ ‘ä¸­çš„ç»“ç‚¹æ•°ï¼Œå°±å¯ä»¥æ‰¾åˆ°æœ€å°çš„ç­”æ¡ˆäº†

å› æ­¤ï¼Œé—®é¢˜åŒ–ä¸ºå¦‚ä½•æ±‚æ‰€æœ‰ç‚¹æœ€å¤§å­æ ‘çš„ç»“ç‚¹æ•°ï¼Œå…¶å®è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å» `dfs`(ä¹Ÿæ˜¯åœ¨ç©·ä¸¾)

å› æ­¤ä¸¤ä¸ªæ­¥éª¤å’Œèµ·æ¥å†™:

1. ç©·ä¸¾ç‚¹çš„è¿‡ç¨‹è®¡ç®—æœ€å¤§å­æ ‘ç»“ç‚¹æ•°
2. åŒæ—¶æ¯”è¾ƒå¾—å‡ºæœ€å°çš„é‚£ä¸ªæ•°

å³åªè¦éå†å®Œæ‰€æœ‰çš„ç‚¹ï¼Œç­”æ¡ˆå°±ä¼šå‡ºæ¥äº†

> å…³äºéå†:
> æ ‘çš„é—®é¢˜å¯ä»¥è½¬æ¢ä¸ºå›¾çš„é—®é¢˜è§£å†³ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“æ ‘çš„æ ¹åœ¨å“ªï¼Œå› æ­¤å»ºè¾¹çš„æ—¶å€™éœ€è¦å»ºåŒå‘è¾¹ï¼Œè¿™æ ·å¯ä»¥ä»»æ„æŒ‡å®šä¸€ä¸ªç‚¹ä½œä¸ºæ ¹ï¼Œè€Œéå†æ ‘æ—¶æ¯ä¸ªç‚¹æˆ‘ä»¬åªèµ°ä¸€æ¬¡ï¼Œå› æ­¤è¿˜éœ€è¦ç”¨`st`æ ‡è¯†æˆ‘ä»¬å·²ç»èµ°è¿‡çš„ç‚¹ï¼Œä½¿éå†å˜æˆå•å‘çš„ã€‚

```cpp
#include <iostream>
#include <cstring>

using namespace std;
const int N = 1e5 + 5, M = N << 1;
int h[N], e[M], ne[M], idx;
char st[N];
int ans = N, n;

void add(int a, int b) {
    e[idx] = b,
    ne[idx] = h[a],
    h[a] = idx ++;
}

int dfs(int u) {
    int res = 0, sum = 1;
    for (int i = h[u]; i != -1; i = ne[i]) {
        int j = e[i];
        if (!st[j]) {
            st[j] = true; // é˜²æ­¢å¾ªç¯è®¿é—®
            int s = dfs(j);
            sum += s;
            res=max(res, s);
        }
    }
    res=max(n-sum, res);
    ans=min(res, ans);
    return sum;
}

int main() {
    cin >> n;
    memset(h, -1, sizeof h);
    for (int i = 0; i < n - 1; i ++) {
        int a, b;
        cin >> a >> b;
        add(a, b), add(b, a);
    }
    dfs(1);
    cout << ans << endl;
    return 0;
}
```

### å…¨æ’åºçš„æšä¸¾

è¿™ä¸ªå¾ˆç®€å•ï¼Œ å¯ä»¥ç”¨æ•°ç»„è¡¨ç¤ºçŠ¶æ€ï¼Œå› ä¸ºçŠ¶æ€æ¯”è¾ƒç®€å•ï¼Œä¹Ÿå¯ä»¥ç”¨ä½æ¥è¡¨ç¤ºçŠ¶æ€

```cpp
#include <iostream>

using namespace std;
const int N = 10;
int res[N];
int n;

void dfs(int u, int status) {
    if (u == n) {
        for (int i = 0; i < n; ++ i) printf("%d ", res[i]);
        puts("");
        return;
    }
    for (int i = 0; i < n ; ++ i)
        if (!(status >> i & 1)) {
            res[u] = i + 1;
            dfs(u + 1, status + (1 << i));
        }
}

int main() {
    cin >> n;
    dfs(0, 0);
}
```

### ç»„åˆçš„æšä¸¾

### å›æº¯

### å‰ªæ

### n çš‡å

ç»å…¸çš„é—®é¢˜ï¼Œç»™`n x n` çš„å›½é™…è±¡æ£‹ç›˜ï¼Œé—®æ‘†æ»¡çš‡å(å®ƒä»¬ä¸èƒ½ç›¸äº’æ”»å‡»åˆ°)ï¼Œæœ‰å‡ ç§æ‘†æ³•

å›½å®¶è±¡æ£‹ä¸­ï¼Œçš‡åèƒ½ç›´çº¿æ”»å‡»ï¼Œå³èƒ½å¤Ÿæ¨ªç«–æ–œæ”»å‡»ï¼Œå› æ­¤æ‘†æ”¾çš‡åæ—¶ä»»æ„ä¸€æ¡æ¨ªã€ç«–ã€æ–œçº¿åªèƒ½æ”¾ä¸€ä¸ªçš‡å

çº¯æšä¸¾ï¼Œä¸ä½¿ç”¨å‰ªæï¼š$O(n^n)$

æŒ‰è¡Œæšä¸¾ï¼Œåˆ†æ”¯ä¸ºåˆ—æ•°ï¼Œå³è¡¨ç¤ºæŸè¡ŒæŸåˆ—æ˜¯å¦æ”¾ç½®æ£‹å­

````cpp
#include <iostream>

using namespace std;
const int N = 12;
char g[N][N], col[N], udg[N << 1], dg[N << 1];

int n;

void dfs(int u) {
    if (u == n) {
        for (int i = 0; i < n; ++ i) puts(g[i]);
        puts("");
        return;
    }
    for (int i = 0; i < n; ++ i)
        if (!col[i] && !dg[u + i] && !udg[u - i + n]){
            g[u][i] = 'Q';
            col[i] = dg[u + i] = udg[u - i + n] = true;
            dfs(u + 1);
            col[i] = dg[u + i] = udg[u - i + n] = false;
            g[u][i] = '.';
        }
}

int main(){
    cin >> n;
    for (int i = 0; i < n; ++ i)
        for (int j = 0; j < n; ++ j)
            g[i][j] = '.';

    dfs(0);

    return 0;
}
```

æŒ‰æ ¼å­ä½ç½®æšä¸¾ï¼Œåˆ†æ”¯ä¸ºæ”¾æˆ–ä¸æ”¾

```cpp
#include <iostream>

using namespace std;
const int N = 12;
char g[N][N], dg[N << 1], udg[N << 1], col[N], row[N];

int n;

void dfs(int x, int y, int u) {
    if (x == n) x = 0, y ++;
    if (y == n) {
        // èµ°åˆ°ç»ˆç‚¹ï¼Œä¸”é€‰äº†nä¸ª
        if (u == n) {
            for (int i = 0; i < n; ++ i) puts(g[i]);
            puts("");
        }
        return;
    }

    // ä¸æ”¾çš„æƒ…å†µ
    g[y][x] = '.';
    dfs(x + 1, y, u);

    // æ”¾çš„æƒ…å†µ
    if (!row[y] && !col[x] && !dg[x + y] && !udg[y - x + n]){
        g[y][x] = 'Q';
        col[x] = row[y] = dg[x + y] = udg[y - x + n] = true;
        dfs(x + 1, y, u + 1);
        col[x] = row[y] = dg[x + y] = udg[y - x + n] = false;
        g[y][x] = '.';
    }
}

int main(){
    cin >> n;

    dfs(0, 0, 0);

    return 0;
}
````

> å…³äºå¯¹è§’çº¿çš„ `index`ï¼Œå› ä¸ºæ£‹ç›˜æ˜¯æ­£æ–¹å½¢çš„æ‰€ä»¥æ¯æ¡å¯¹è§’çº¿çš„æ–œç‡éƒ½ä¸º `1` ä¸ç”¨è€ƒè™‘ï¼Œ
> å› æ­¤å¯ä»¥ä½¿ç”¨åœ¨åæ ‡è½´ä¸Šçš„æˆªè·ï¼Œæ¥åŒºåˆ«ä¸åŒçš„å¯¹è§’çº¿ï¼Œåå¯¹è§’çº¿:`b_ = y + x`ï¼Œæ­£å¯¹è§’çº¿:`b = y - x + n`
> åŠ  n æ˜¯ä¸ºäº†é˜²æ­¢æˆªè·å‡ºç°è´Ÿæ•°

### æ•°ç‹¬æ±‚è§£

## BFS

ä¸€èˆ¬å’Œé˜Ÿåˆ—è”ç³»åœ¨ä¸€èµ·

å®½åº¦ä¼˜å…ˆæœç´¢ï¼Œå³ä¼˜å…ˆæœç´¢èŠ‚ç‚¹çš„å…¨éƒ¨å­èŠ‚ç‚¹ï¼Œä¸€åœˆä¸€åœˆåœ°éå†ã€‚
æŠŠé˜Ÿåˆ—çš„é¦–å…ƒç´ å¼¹å‡ºï¼ŒæŠŠå…¶æŠŠå­èŠ‚ç‚¹æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œé‡å¤æ­¥éª¤ç›´åˆ°éå†å…¨éƒ¨èŠ‚ç‚¹

### æœ€çŸ­è·¯

#### èµ°è¿·å®«

ç»™ `n x m` çš„åœ°å›¾ï¼Œ`1` è¡¨ç¤ºä¸èƒ½é€šè¿‡ï¼Œ`0` è¡¨ç¤ºèƒ½é€šè¿‡

é—®ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’æœ€çŸ­è·¯å¾„

ç”¨æ•°ç»„ `d` è¡¨ç¤ºä»èµ·ç‚¹åˆ°æŸç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œé‚£ä¹ˆèƒ½å¤Ÿåˆ°è¾¾æŸç‚¹çš„ä¸Šä¸€ç‚¹çš„æœ€çŸ­è·¯å¾„`+1`å°±å¾—åˆ°è¯¥ç‚¹åˆ°èµ·ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚
å› ä¸º `bfs` æ˜¯ä¸€å±‚ä¸€å±‚éå†çš„ï¼Œå› æ­¤å¯¹äºåŒä¸€ä¸ªç‚¹ï¼Œå…ˆéå†å¾—åˆ°çš„è·¯å¾„é•¿åº¦ä¸€å®šæ¯”åéå†å¾—åˆ°çš„è·¯å¾„çŸ­ï¼Œ
æ‰€ä»¥å¦‚æœ `d` å·²ç»æœ‰å€¼ï¼Œé‚£ä¹ˆæ— éœ€æ›´æ–°äº†ã€‚

æ‰‹å†™é˜Ÿåˆ—:

```cpp
#include <iostream>
#include <cstring>

using namespace std;
typedef pair<int, int> PII;
const int N = 105;

int g[N][N], d[N][N];
PII q[N * N];
int n, m;
int hh = 0, tt = -1;

int bfs() {
    int dx[4] = {0, -1, 0, 1};
    int dy[4] = {-1, 0, 1, 0};
    memset(d, -1, sizeof d);
    q[++ tt] = {0, 0};
    d[0][0] = 0;
    while (hh <= tt){
        auto t = q[hh ++];
        for (int i = 0; i < 4; ++ i) {
            int x = t.first + dx[i], y = t.second + dy[i];
            if (x < m && x >= 0 && y < n && y >= 0 && d[y][x] == -1 && !g[y][x]) {
                d[y][x] = d[t.second][t.first] + 1;
                q[++ tt] = {x, y};
            }
        }
    }
    return d[n - 1][m - 1];
}

int main(){
    cin >> n >> m;
    for (int i = 0; i < n; ++ i)
        for (int j = 0; j < m; ++ j)
            cin >> g[i][j];
    cout << bfs() << endl;
    return 0;
}
```

STL:

```cpp
#include <iostream>
#include <cstring>
#include <queue>

using namespace std;
typedef pair<int, int> PII;
const int N = 105;

int g[N][N], d[N][N];
queue<PII> q;
int n, m;

int bfs() {
    int dx[4] = {0, -1, 0, 1};
    int dy[4] = {-1, 0, 1, 0};
    memset(d, -1, sizeof d);
    q.push({0, 0});
    d[0][0] = 0;
    while (q.size()){
        auto t = q.front();
        q.pop();
        for (int i = 0; i < 4; ++ i) {
            int x = t.first + dx[i], y = t.second + dy[i];
            if (x < m && x >= 0 && y < n && y >= 0 && d[y][x] == -1 && !g[y][x]) {
                d[y][x] = d[t.second][t.first] + 1;
                q.push({x, y});
            }
        }
    }
    return d[n - 1][m - 1];
}

int main(){
    cin >> n >> m;
    for (int i = 0; i < n; ++ i)
        for (int j = 0; j < m; ++ j)
            cin >> g[i][j];
    cout << bfs() << endl;
    return 0;
}
```

#### å…«æ•°ç 

ç»™å®šä¸€ä¸ªå…«å­—ç ï¼Œ`x` è¡¨ç¤ºç©ºä½(å³å¯ä»¥ç§»åŠ¨çš„æ ¼å­)ï¼Œè¾“å‡ºæŠŠå…«å­—ç è¿˜åŸ(å³æ²¡æœ‰é€†åºå¯¹ï¼Œä¾æ¬¡é€’å¢)çš„æœ€å°‘ç§»åŠ¨çš„æ¬¡æ•°
ï¼Œè‹¥æ— æ³•è¿˜åŸè¾“å‡º `-1`

> æ•°åˆ—çš„é€†åºæ•°æ˜¯å¥‡æ•°æ—¶ï¼Œå…«å­—ç æ— è§£ï¼Œè¯æ˜ç•¥

```
// æŠŠä¸Šé¢è¿˜åŸä¸ºä¸‹é¢
2 3 4
1 5 x
7 6 8

1 2 3
4 5 6
7 8 x
```

å…¶å®è¿˜æ˜¯æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œä¸”å¯ä»¥ä½¿ç”¨`bfs`æš´åŠ›æ±‚è§£ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªæ•°åˆ—å½“æˆä¸€ä¸ªçŠ¶æ€(æ ‘çš„ä¸€ä¸ªèŠ‚ç‚¹)ï¼Œ`x`
ä¸Šä¸‹å·¦å³äº¤æ¢ä½œä¸ºè½¬ç§»(æ ‘çš„åˆ†æ”¯)ï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“ï¼Œåªè¦èƒ½éå†åˆ°`12345678x`çš„çŠ¶æ€ï¼Œå°±å¯ä»¥å¾—åˆ°æœ€å°‘ç§»åŠ¨æ¬¡æ•°,
å³è½¬æ¢ä¸ºæœ€çŸ­è·¯å¾„é—®é¢˜ã€‚

åŒæ ·ï¼Œ`bfs` æ˜¯ä¸€å±‚ä¸€å±‚éå†çš„ï¼Œå› æ­¤å…ˆåˆ°è¾¾çŠ¶æ€çš„è·¯å¾„æ˜¯æœ€çŸ­çš„ï¼Œåç»­å†æ¬¡åˆ°è¾¾è¯¥çŠ¶æ€æ— éœ€æ›´æ–°

```cpp
#include <iostream>
#include <queue>
#include <unordered_map>

using namespace std;

int bfs(string st){
    queue<string> q;
    unordered_map<string,int> d;
    int dx[] = {0, 1, 0, -1}, dy[] = {-1, 0, 1, 0};
    q.push(st);
    d[st] = 0;
    string end = "12345678x";
    while (q.size()) {
        auto t = q.front();
        q.pop();
        if (t == end) return d[t];
        int pos = t.find('x');
        int x = pos % 3, y = pos / 3;
        int dist = d[t];
        for (int i = 0; i < 4 ; ++ i) {
            int a = x + dx[i], b = y + dy[i];
            if (a >= 0 && a < 3 && b >= 0 && b < 3) {
                swap(t[y * 3  + x], t[b * 3 + a]);
                if (!d.count(t)) { // æ˜¯å¦å·²ç»éå†è¿‡è¯¥çŠ¶æ€äº†
                    d[t] = dist + 1;
                    q.push(t);
                }
                swap(t[y * 3  + x], t[b * 3 + a]);
            }
        }
    }
    return -1;
}

int main(){
    string st;
    for (int i = 0; i < 9; i ++){
        char op;
        cin >> op;
        st += op;
    }
    cout << bfs(st) << endl;

    return 0;
}
```

#### Dijkstra

ä¾æ¬¡é€‰å–**ç¦»å‡ºå‘ç‚¹è·ç¦»æœ€è¿‘çš„ç‚¹**å»æ›´æ–°å…¶ä»–ç‚¹åˆ°å‡ºå‘ç‚¹çš„è·ç¦»ï¼Œå°†é€‰è¿‡çš„ç‚¹åŠ å…¥é›†åˆï¼Œå½“å…¨éƒ¨ç‚¹åŠ å…¥é›†åˆåï¼Œå³å¯ç»“æŸï¼Œæ­¤æ—¶å„ä¸ªç‚¹åˆ°å‡ºå‘ç‚¹çš„è·ç¦»å°±æ˜¯æœ€çŸ­è·ç¦»ï¼Œå„ä¸ªç‚¹åŠ å…¥é›†åˆçš„é¡ºåºå°±æ˜¯æœ€çŸ­è·ç¦»çš„å‡ºå‘é¡ºåºã€‚

:::tip ä¸ä¸¥è°¨è¯æ˜
ç»“è®ºï¼š<br>
æ¯ä¸€æ¬¡é€‰å…¥é›†åˆçš„ç‚¹éƒ½æ˜¯ä¸Šä¸ªç‚¹æˆ–ä¸Šè‹¥å¹²ä¸ªç‚¹ï¼ˆèµ·ç‚¹åˆ°è¯¥ç‚¹çš„è·¯å¾„å·²ç»æœ€çŸ­ï¼‰åˆ°å®ƒèƒ½æŠµè¾¾çš„ç‚¹ä¸­æœ€å°è·ç¦»çš„ç‚¹(æœ€å°+æœ€å°)ï¼Œå› æ­¤èµ·ç‚¹åˆ°è¿™ç‚¹çš„è·¯å¾„ä¹Ÿæ˜¯æœ€çŸ­çš„ã€‚

å³ï¼š<br>
O ç‚¹ï¼ˆèµ·ç‚¹ï¼‰åˆ° A ç‚¹å·²ç»æ˜¯æœ€å°çš„ï¼Œå› æ­¤å¦‚æœä» O ç‚¹åˆ° A ç‚¹å†åˆ° B ç‚¹ï¼Œæ˜¯ç›®å‰ O ç‚¹åˆ°æ‰€æœ‰æœªåŠ å…¥é›†åˆç‚¹ä¸­è·¯å¾„æœ€å°çš„ï¼Œé‚£ä¹ˆ O ç‚¹åˆ° B ç‚¹çš„è·ç¦»æ˜¯æœ€å°çš„

æ¡ä»¶ï¼š

1. A èƒ½æ›´æ–° B(åˆ°è¾¾)
2. OB æ˜¯ç›®å‰èƒ½é€‰å‡ºçš„æœ€å°è¾¹

è¯æ˜ï¼š

- æœ‰ä¸€ä¸ªç­‰å¼ï¼š

$$P_{min}(V_o,V_b) = P_{min}(V_o,V_a) + P_{min}(V_a,V_b)$$

( $P_{min}(V_x,V_y)$è¡¨ç¤º X ç‚¹åˆ° Y ç‚¹çš„æœ€å°è·ç¦»ã€‚ )

æ³¨æ„è¿™é‡Œçš„å‰æ: B è¢« A æ›´æ–°äº†;

å¦‚æœåœ¨ A ä¹‹å‰å­˜åœ¨æŸç‚¹ X ä½¿
$P_{min}(V_o,V_x) + P_{min}(V_x,V_b) < P_{min}(V_o,V_a) + P_{min}(V_a, V_b)$ é‚£ B å°±ä¸ä¼šè¢« A æ›´æ–°;

é‚£åœ¨ A ä¹‹åå‘¢ï¼Ÿæ›´ä¸å¯èƒ½äº†ï¼Œç”± A æ›´æ–°å‡ºæ¥çš„ç‚¹è·ç¦»è‚¯å®šæ¯” A å°å˜›(æ›´æ–°çš„æ›´æ–°æ›´å°)ï¼Œæ‰€ä»¥ä¸Šé¢çš„ç­‰å¼æ˜¯æ’æˆç«‹çš„

åˆå› ä¸º B ç‚¹æ˜¯ A ç‚¹èƒ½åˆ°è¾¾ç‚¹ä¸­è·ç¦»æœ€å°ç‚¹ï¼Œå› æ­¤å¯ä»¥å¾—åˆ°$P_{min}(V_A,V_B) = W(V_A,V_B)$

åˆ™å¯è¯ï¼š
$$P_{min}(V_o,V_b) = P_{min}(V_o,V_a) + W(V_a,V_b)$$

é‚£ä¸ºä»€ä¹ˆ B ç‚¹æ˜¯ A ç‚¹èƒ½åˆ°è¾¾ç‚¹ä¸­è·ç¦»æœ€å°ç‚¹ ?

å› ä¸º B ç‚¹åˆ° O ç‚¹çš„è·ç¦»æ˜¯ç”± A ç‚¹æ›´æ–°æ¥çš„ï¼Œè€Œåœ¨æ‰€æœ‰è¢« A ç‚¹æ›´æ–°æˆ–æ²¡æ›´æ–°çš„ç‚¹ä¸­ï¼ŒB åˆ° O ç‚¹çš„è·ç¦»æ˜¯æœ€å°çš„(æ¡ä»¶ 2)ï¼Œé‚£ä¹ˆå¯ä»¥è¯´æ˜
A ç‚¹æ›´æ–°åˆ°çš„ç‚¹ä¸­ï¼ŒA ç‚¹åˆ° B çš„è·ç¦»ä¹Ÿæ˜¯æœ€çŸ­çš„

è¯æ˜ç»“æŸ
:::

> æˆ‘ä¹ŸçŸ¥é“è¯æ˜å¾ˆçƒ‚ï¼Œåªæ˜¯ä¸ºäº†ç®€å•è®°ä¸ªç»“è®º ğŸ·
>
> btwï¼Œæˆ‘å‘ç° bfs çš„æœ€å°è·¯å¾„é—®é¢˜ï¼ŒåŸºæœ¬éƒ½æœ‰çš„ç»“è®ºï¼š
>
> 1. æœ€å° = æœ€å° + æœ€å°
> 2. å…ˆåˆ°è¾¾çš„å€¼å°äºååˆ°è¾¾çš„å€¼

å› ä¸ºæ¯æ¬¡é€‰å–æœ€å°è·ç¦»éƒ½éœ€è¦éå†ä¸€éæœªåŠ å…¥é›†åˆçš„ç‚¹è·ç¦»ï¼Œæœ´ç´ ç‰ˆçš„ dijkstra çš„é€Ÿåº¦è¢«é™åˆ¶åˆ°$O(n^2)$

> æ³¨æ„ï¼š
>
> - dijkstra ç®—æ³•ä¸èƒ½åœ¨è¾¹æƒä¸ºè´Ÿæ•°çš„æƒ…å†µä¸‹ä½¿ç”¨
> - dijkstra ç®—æ³•ä»…èƒ½å¾—åˆ°åˆå§‹ç‚¹åˆ°å„ç‚¹çš„æœ€å°è·ç¦»

æ­¥éª¤ï¼š

1. scanï¼ˆæ‰¾å‡ºé›†åˆå¤–è·ç¦»åˆå§‹ç‚¹æœ€è¿‘çš„ç‚¹ï¼‰ï¼ˆå¯ä¼˜åŒ–ï¼‰
2. addï¼ˆå°†è¯¥ç‚¹åŠ å…¥é›†åˆï¼‰
3. updataï¼ˆæ›´æ–°æœªåŠ å…¥é›†åˆå„ç‚¹åˆ°è¯¥ç‚¹çš„è·ç¦»ï¼‰

å¤æ‚åº¦ï¼š

- æ—¶é—´ï¼š$O(n^2)$
- ç©ºé—´ï¼š
  - ç¨€ç–å›¾ï¼š$O(n)$
  - ç¨ å¯†å›¾ï¼š$O(n^2)$

> å…³äºå¦‚ä½•åˆ¤å›¾åƒçš„ç–å¯†ï¼Œä¸€èˆ¬æ¥è¯´ `n^2 >> m` ä¸ºç¨€ç–

```cpp
#include <iostream>
#include <algorithm>
#include <cstring>

using namespace std;
const int N = 510;
int g[N][N];
bool st[N];
int dist[N];

int n, m;

int dijkstra(){
    memset(dist, 0x3f , sizeof dist);  //åˆå§‹åŒ–è·ç¦»ä¸ºæ— ç©·
    dist[1] = 0;

    for (int i = 0 ; i < n ; i ++){  //n æ¬¡å¾ªç¯ï¼Œæ¯æ¬¡å°†ä¸€ä¸ªç‚¹åŠ å…¥é›†åˆ
        int t = -1;

        for (int j = 1; j <= n ; j ++)
            if (!st[j] && (t == -1 || dist[t] > dist[j]))
                t = j;  //é€‰å‡ºæœªåŠ å…¥é›†åˆä¸­æœ€è¿‘çš„ç‚¹

        st[t] = true;  //åŠ å…¥é›†åˆ

        for (int j = 1 ; j <= n ; j ++){  //ç”¨è¯¥ç‚¹æ›´æ–°å…¶ä»–æœªåŠ å…¥é›†åˆä¸­çš„ç‚¹è·ç¦»
            if (!st[j])  //å› ä¸ºæœ€çŸ­çš„è·ç¦»ä¼šå…ˆè¢«é€‰å–ï¼Œå› æ­¤ï¼Œé€‰å–è¿‡çš„ç‚¹æ— éœ€è¢«æ›´æ–°ã€‚
              dist[j] = min(dist[j], dist[t] + g[t][j]);
        }
    }

    if (dist[n] == 0x3f3f3f3f) return -1;  //è‹¥æ— æ³•åˆ°è¾¾æŸç‚¹ï¼Œè·ç¦»ä¸ºæ— ç©·
    return dist[n];
}

int main()
{
    cin >> n >> m;

    memset(g, 0x3f, sizeof g);
    while (m --){
        int a, b, c;
        cin >> a >> b >> c;
        g[a][b] = min(c, g[a][b]); // æ²¡æœ‰é›ä½™æ•°æ®
    }

    cout << dijkstra() << endl;

    return 0;
}
```

> å¯ä»¥ç”¨å¦ä¸ªæ•°ç»„è®°å½•å°†ç‚¹åŠ å…¥é›†åˆçš„é¡ºåºï¼ˆå³åˆ°è¾¾å½“å‰ç‚¹çš„å‰ä¸€ä¸ªç‚¹ï¼‰ï¼Œå¯ä»¥é€’æ¨å‡ºåˆå§‹ç‚¹èµ°åˆ°æŸç‚¹çš„è·¯å¾„

<br>

#### Dijkstra + Heap

ä½¿ç”¨å †ä¼˜åŒ– dijkstra scan æ­¥éª¤

å¤æ‚åº¦ï¼š

- æ—¶é—´ï¼š$O(mlogn)$
- ç©ºé—´ï¼š
  - ç¨€ç–å›¾ï¼š$O(n)$
  - ç¨ å¯†å›¾ï¼š$O(n^2)$

```cpp
#include <iostream>
#include <cstring>
#include <queue>

using namespace std;
typedef pair<int, int> PII;

const int N = 1000010;
int e[N], ne[N], w[N], h[N], idx;
bool st[N];
int dist[N];

int n, m;

void add(int a, int b, int c){
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++;
}

int dijkstra(){
    memset(dist, 0x3f, sizeof dist);
    dist[1] = 0;

    priority_queue<PII, vector<PII>, greater<PII>> heap;  //å¤§æ ¹å †ï¼Œæ¯æ¬¡å–å‡ºæœ€å°çš„è·ç¦»
    heap.push({0, 1});

    while (heap.size()){
        auto t = heap.top();
        heap.pop();

        int ver = t.second, distance = t.first;

        if (st[ver]) continue;
        //è‹¥è¯¥ç‚¹å·²ç»åŠ å…¥è¿‡é›†åˆï¼Œç»§ç»­åˆ¤æ–­ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œæ˜¯ä¸ºäº†è·³è¿‡é›ä½™çš„æ•°æ®
        st[ver] = true;  //æœªåŠ å…¥è¿‡é›†åˆï¼ŒåŠ å…¥é›†åˆ

        for (int i = h[ver] ; i != -1 ; i = ne[i]){
            int j = e[i];

            if (dist[j] > distance + w[i] ){
                dist[j] = distance + w[i];
                heap.push({dist[j], j});  //æˆåŠŸæ›´æ–°ç‚¹åï¼Œå…¨éƒ¨åŠ å…¥å †ä¸­æ’åºï¼Œå¾…é€‰å–åŠ å…¥é›†åˆ
            }
        }
    }
    if (dist[n] == 0x3f3f3f3f) return -1;  //è‹¥æ— æ³•åˆ°è¾¾æŸç‚¹ï¼Œè·ç¦»ä¸ºæ— ç©·

    return dist[n];
}

int main()
{
    cin >> n >> m;

    memset(h, -1, sizeof h);
    while (m --){
        int a, b, c;
        cin >> a >> b >> c;
        add(a, b, c); // ä¼šäº§ç”Ÿé›ä½™æ•°æ®
    }

    cout << dijkstra() << endl;

    return 0;
}
```

<br>

#### Bellman-Ford

`bellman_ford` åªéœ€è¦å°†æ¯æ¡è¾¹å­˜ä¸‹æ¥ï¼Œè€Œä¸éœ€è¦ç”¨å¤æ‚çš„æ•°æ®ç»“æ„å­˜å›¾ï¼Œ`bellman_ford` ç®—æ³•é€‚åˆç”¨æ¥è§£å†³æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯å¾„é—®é¢˜ã€‚

å®é™…å«ä¹‰ï¼šåœ¨ k æ¡è¾¹å†…æ‰¾åˆ°èµ·ç‚¹åˆ°ç¬¬ n ç‚¹(ä¸ä¸€å®šæ˜¯é‚£ä¸ªç‚¹)çš„æœ€çŸ­è·ç¦»

è‹¥é™åˆ¶ä¸º kï¼Œå³åªèƒ½å¾ªç¯ k æ¬¡ï¼Œæ¯æ¬¡å¾ªç¯å°†æ¯æ¡è¾¹è¿›è¡Œä¸€æ¬¡æ¾å¼›æ“ä½œï¼Œæ¾å¼›æ“ä½œï¼šç”±ä¸€æ¡è¾¹çš„æœ«ç«¯ä½¿ç”¨è¾¹çš„é¦–ç«¯æ›´æ–°æœ«ç«¯åˆ°èµ·ç‚¹çš„è·ç¦»(å¦‚æœèƒ½æ›´æ–°çš„è¯)

å®é™…ä¸Šçš„æ¾å¼›æ“ä½œä¼šå…ˆæ›´æ–°ä¸èµ·ç‚¹ç›¸è¿çš„æ‰€æœ‰è¾¹(ç”±èµ·ç‚¹å‡ºå‘)ï¼Œå†æ›´æ–°ä¸è¿™äº›è¾¹ç›¸è¿çš„è¾¹ï¼Œçœ‹èµ·æ¥å°±åƒæ˜¯ `bfs` ä¸€å±‚ä¸€å±‚å‘å¤–æ‰©å±•

> å…¶å®æŒºå½¢è±¡çš„ï¼Œæ¯ä¸€æ¬¡éƒ½åªèµ°ä¸€æ®µï¼Œå¦‚æœè¿™æ®µæ›´æ–°çš„è·ç¦»æ¯”ä¹‹å‰çš„è·ç¦»çŸ­ï¼Œå°±æ›´æ–°;
> å› ä¸ºå—æ¬¡æ•°é™åˆ¶ï¼Œæœ€ååˆ°è¾¾ n ç‚¹æ—¶å¹¶ä¸ä¸€å®šæ˜¯çœŸæ­£çš„æœ€çŸ­è·ç¦»

æ­¥éª¤ï¼š

1. k æ¬¡å¾ªç¯
2. æ¯ä¸€æ¬¡å¾ªç¯æ›´æ–°æ‰€æœ‰çš„è¾¹

å¤æ‚åº¦ï¼š

- æ—¶é—´ï¼š$O(km)$
- ç©ºé—´ï¼š$O(m)$

```cpp
#include <iostream>
#include <cstring>
#include <algorithm>

using namespace std;
const int N = 510, M = 1e4 + 10;
int dist[N], bk[N];

struct Edge{
    int a, b, w;
}edge[M];

int n, m, k;

int bellman_ford(){
    memset(dist, 0x3f, sizeof dist);
    dist[1] = 0;

    for (int i = 0 ; i < k ; i ++){
        memcpy(bk, dist, sizeof bk); //ç”¨ä¸Šæ¬¡çš„è¾¹æ›´æ–°ï¼Œèƒ½é˜²æ­¢æŸç‚¹å·²ç»è¢«æ›´æ–°åï¼Œåˆæ‹¿å»æ›´æ–°å…¶ä»–ç‚¹ï¼Œå³èƒ½ä¿è¯æ¯æ¬¡åªèµ°ä¸€æ¡è¾¹
        for (int j = 0 ; j < m ; j ++){
            auto e = edge[j];
            dist[e.b] = min(dist[e.b], bk[e.a] + e.w);
        }
    }
}

int main()
{
    cin >> n >> m >> k;

    for (int i = 0 ; i < m ; i ++){
        int a, b, w;
        scanf("%d%d%d", &a, &b, &w);
        edge[i] = {a, b, w};
    }

    bellman_ford();

    if (dist[n] >= 0x3f3f3f3 / 2) puts("impossible");  //æœ‰è´Ÿè¾¹æƒï¼Œæ›´æ–°æ—¶å¯èƒ½å‡æ‰äº†ä¸€éƒ¨åˆ†
    else cout << dist[n] << endl;

    return 0;
}
```

<br>

#### Spfa

spfa æ˜¯ bellman-ford çš„ä¼˜åŒ–ï¼Œåœ¨ bellman-ford ä¸­æ¯æ¬¡å¾ªç¯éƒ½è¦æ›´æ–° m æ¡è¾¹ï¼Œäº‹å®ä¸Šä¸éœ€è¦æ¯æ¡è¾¹éƒ½æ›´æ–°ã€‚

è‹¥è¦åˆ°è¾¾ b ç‚¹ï¼Œä¸”é€”ä¸­ç»è¿‡ a ç‚¹ï¼Œåˆ™è¦ç”¨ a ç‚¹æ¥æ›´æ–° bï¼Œå½“ä¸”ä»…å½“ a ç‚¹è¢«æ›´æ–°è¿‡åï¼Œæ‰éœ€è¦æ›´æ–° b ç‚¹(`dist[b] = last[a] + g[a][b]`)

å› æ­¤å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—æ¥ä¿å­˜æ›´æ–°è¿‡çš„ç‚¹ï¼Œä»…å½“è¿™äº›ç‚¹è¢«æ›´æ–°è¿‡ï¼Œæ‰æ‹¿ä»–ä»¬å»æ›´æ–°å…¶ä»–ç‚¹ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨ st æ•°ç»„è®°å½•æ›´æ–°è¿‡çš„ç‚¹ï¼Œé˜²æ­¢é‡å¤å†—ä½™

ï¼ˆè¿™é‡Œçš„ st å’Œ dijkstraï¼Œprim ä¸­ç”¨äºè¡¨ç¤ºé›†åˆçš„ st åŠŸèƒ½ä¸åŒ,
è¡¨ç¤ºè¯¥ç‚¹æ˜¯å¦å·²ç»æ”¾å…¥é˜Ÿåˆ—ç”¨äºæ›´æ–°å…¶ä»–ç‚¹ï¼Œé˜²æ­¢å¤šä½™çš„æ›´æ–°ï¼‰

> å«æœ‰è´Ÿæƒè¾¹çš„æœ€å°è·¯å¾„é—®é¢˜ï¼Œå¯ä»¥ä¼˜å…ˆè€ƒè™‘ Spfa ç®—æ³•ï¼Œè‹¥åªæœ‰æ­£æƒè¾¹ï¼Œä¸” spfa è¿‡ä¸äº†å†è€ƒè™‘ dijkstra

æ­¥éª¤ï¼š

1. popï¼ˆæŠŠé˜Ÿåˆ—ä¸­ç”¨äºæ›´æ–°çš„è¾¹å–å‡ºï¼‰
2. updataï¼ˆç”¨æ›´æ–°è¿‡çš„è¾¹å»æ›´æ–°å…¶ä»–è¾¹ï¼‰
3. addï¼ˆæŠŠæ–°æ›´æ–°çš„è¾¹åŠ å…¥é˜Ÿåˆ—å¾…ç”¨äºæ›´æ–°å…¶ä»–è¾¹ï¼‰

å¤æ‚åº¦ï¼š

- æ—¶é—´ï¼šæœ€ä¼˜ä¸º$O(m)$ï¼Œæœ€åä¸º$O(nm)$
- ç©ºé—´ï¼š
  - ç¨€ç–å›¾ï¼š$O(n)$
  - ç¨ å¯†å›¾ï¼š$O(n^2)$

```cpp
#include <iostream>
#include <cstring>
#include <queue>

using namespace std;
const int N = 1e5 + 10;
int e[N], ne[N], h[N], w[N], idx;
int dist[N];
bool st[N];

int n, m;

void add(int a, int b, int c){
    e[idx] = b;
    w[idx] = c;
    ne[idx] = h[a];
    h[a] = idx ++;
}

void spfa(){
    memset(dist, 0x3f, sizeof dist);
    dist[1] = 0;

    queue<int> q;
    q.push(1);
    st[1] = true;

    while (q.size()){
        int t = q.front();
        q.pop();

        st[t] = false; // ä¸åœ¨é˜Ÿåˆ—ä¸­äº†

        for (int i = h[t]; i != -1;  i = ne[i]){
            int j = e[i];
            if (dist[j] > dist[t] + w[i]){
                dist[j] = dist[t] + w[i];
                if (!st[j]){ // å¦‚æœè¯¥ç‚¹å·²ç»æ”¾åœ¨é˜Ÿåˆ—ï¼Œå°±æ²¡å¿…è¦å†æ”¾ä¸€æ¬¡
                    q.push(j);
                    st[j] = true;
                }
            }
        }
    }
}

int main()
{
    cin >> n >> m;
    memset(h, -1, sizeof h);

    while (m --){
        int a, b, c;
        cin >> a >> b >> c;
        add(a, b, c);
    }

    spfa();

    if (dist[n] >= 0x3f3f3f3f / 2) puts("impossible");
    else cout << dist[n];

    return 0;
}
```

<br>

#### Floyd

floyd åŸºäº dp æƒ³æ³•ï¼Œæ±‚ä¸¤ç‚¹é—´æœ€çŸ­è·ç¦»ï¼Œè‹¥ä¸¤ç‚¹é—´å­˜åœ¨å…¶ä»–ç‚¹ï¼Œåˆ™æ±‚è¯¥ç‚¹åˆ°ä¸¤ç«¯ç‚¹çš„æœ€å°è·ç¦»ï¼Œè‹¥æœ‰å¤šä¸ªç‚¹åˆ™å¯çŸ¥é“ï¼Œåªè¦ä½¿æ¯ä¸ªç‚¹é—´çš„è·ç¦»æœ€å°ï¼Œåˆ™ä¸¤ç«¯ç‚¹çš„è·ç¦»æ˜¯æœ€å°çš„ã€‚

> ğŸ· è®°å¾— k è¦åœ¨æœ€å¤–å±‚ï¼Œä¸”åˆå§‹åŒ– dist[i][i] =
> 0ï¼ŒæŒ‰ç†æ¥è¯´è‡ªç¯æƒé‡ä¸åº”å½“å…¨éƒ¨é»˜è®¤ä¸º`0`ï¼Œä¹Ÿè®¸å’Œ dp çš„ä¿¡æ¯æœ‰å…³, å¾…è¡¥å……

> è·¯å¾„ï¼šå¯ä»¥ä½¿ç”¨äºŒç»´æ•°ç»„è®°å½•`path[i][j]`ï¼Œå³æ¯æ¬¡æ›´æ–°è·ç¦»éƒ½æœ‰`path[i][j] = path[i][k]`, é‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°ï¼Œi åˆ° j çš„è·¯å¾„

<br>

å¤æ‚åº¦ï¼š

- æ—¶é—´ï¼š$O(n^3)$
- ç©ºé—´ï¼š$O(n^2)$

```cpp
#include <iostream>

using namespace std;
const int N = 2e4 + 10, INF = 1e9;
int d[N][N];

int n, m, q;

void floyd(){
    for (int k = 1 ; k <= n ; k ++)
        for (int i = 1 ; i <= n ; i ++)
            for (int j = 1 ; j <= n ; j ++)
                if (d[i][j] > d[i][k] + d[k][j])
                    d[i][j] = d[i][k] + d[k][j];

}

int main()
{
    cin >> n >> m >> q;

    for (int i = 1 ; i <= n ; i ++)
        for (int j = 1 ; j <= n ; j ++)
            if (i == j) d[i][j] = 0;
            else d[i][j] = INF;

    while (m --){
        int a, b, c;
        cin >> a >> b >> c;
        d[a][b] = min(d[a][b], c);
    }

    floyd();

    while (q --){
        int a, b;
        cin >> a >> b;
        if (d[a][b] > INF / 2) puts("impossible");
        else cout << d[a][b] << endl;
    }

    return 0;
}
```

##### spfa åˆ¤æ–­è´Ÿç¯

å¢åŠ  cnt æ•°ç»„ï¼Œè¡¨ç¤ºè™šæ‹Ÿèµ·ç‚¹åˆ°æŸç‚¹ç»è¿‡çš„è¾¹æ•°ï¼Œå¦‚æœ`cnt[x] >=
n`ï¼Œå³ä»è™šæ‹Ÿèµ·ç‚¹åˆ°æŸç‚¹ç»è¿‡äº† n æ¡è¾¹ï¼Œé‚£ä¹ˆèµ·ç ç»è¿‡äº†`n+1`ä¸ªç‚¹ï¼Œé¢˜æ„çŸ¥æ€»ç‚¹æ•°ä¸º`n`, ç”±æŠ½å±‰åŸç†å¯çŸ¥å…¶ä¸­ç»è¿‡äº†åŒä¸€ç‚¹(ç¯)ï¼Œåˆç”±äºè™šæ‹Ÿèµ·ç‚¹åˆ°æ‰€æœ‰ç‚¹çš„åˆå§‹åŒ–è·ç¦»ä¸º`0`ï¼Œé‚£ä¹ˆèµ·ç‚¹åˆ°è¯¥ç‚¹ç»è¿‡çš„ç¯å¿…ç„¶æ˜¯è´Ÿç¯(ç¯çš„è¾¹æ€»å’Œä¸ºè´Ÿæ•°)ï¼Œå› ä¸ºç»è¿‡ä¸€æ¬¡è·ç¦»å°±ä¼šå˜å°ï¼Œå¦‚æœä¸æ˜¯è´Ÿç¯ï¼Œå°±ä¸ä¼šç»è¿‡äº†ã€‚

```cpp
#include <bits/stdc++.h>

using namespace std;
const int N = 1e5 + 4;
int e[N], ne[N], w[N], h[N], idx;
int dist[N], cnt[N];
bool st[N];
int n, m;

void add(int a, int b, int c) {
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++;
}

bool spfa() {
    queue<int> q;
    for (int i = 1; i <= n; i ++) {
        q.push(i);
        st[i] = 1;
    }
    while(q.size()) {
        auto t = q.front();
        if (cnt[t] >= n) return true;
        q.pop();
        st[t] = 0;
        for (int i = h[t]; i != -1; i = ne[i]) {
            int j = e[i];
            if (dist[j] > w[i] + dist[t]){
                dist[j] = w[i] + dist[t];
                if (!st[j])  q.push(j), cnt[j] = cnt[t] + 1;
            }
        }
    }
    return false;
}

int main() {
    cin >> n >> m;
    memset(h, -1, sizeof h);

    while(m --) {
        int a, b, c;
        cin >> a >> b >> c;
        add(a, b, c);
    }

    if (spfa()) puts("Yes");
    else puts("No");

    return 0;
}
```

### æ‹“æ‰‘æ’åº

æ‹“æ‰‘åºåˆ—æ˜¯é’ˆå¯¹<mark>æœ‰å‘å›¾</mark>çš„æ¦‚å¿µã€‚<br>
æ‹“æ‰‘æ’åºï¼Œæ˜¯å¯¹ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ G è¿›è¡Œæ‹“æ‰‘æ’åºï¼Œå°† G ä¸­æ‰€æœ‰é¡¶ç‚¹æ’æˆä¸€ä¸ªçº¿æ€§åºåˆ—ï¼Œä½¿å¾—å›¾ä¸­ä»»æ„ä¸€å¯¹é¡¶ç‚¹ u å’Œ vï¼Œè‹¥è¾¹(u,v)âˆˆE(G)ï¼Œåˆ™ u åœ¨çº¿æ€§åºåˆ—ä¸­å‡ºç°åœ¨ v ä¹‹å‰ã€‚é€šå¸¸ï¼Œè¿™æ ·çš„çº¿æ€§åºåˆ—ç§°ä¸ºæ»¡è¶³æ‹“æ‰‘æ¬¡åºçš„åºåˆ—ï¼Œç®€ç§°æ‹“æ‰‘åºåˆ—ã€‚

ç®€å•çš„è¯´ï¼Œç”±æŸä¸ªé›†åˆä¸Šçš„<mark>ä¸€ä¸ªååºå¾—åˆ°è¯¥é›†åˆä¸Šçš„ä¸€ä¸ªå…¨åº</mark>ï¼Œè¿™ä¸ªæ“ä½œç§°ä¹‹ä¸ºæ‹“æ‰‘æ’åºã€‚<br>
å¯ä»¥è¯æ˜æœ‰å‘æ— ç¯å›¾ä¸€å®šå­˜åœ¨æ‹“æ‰‘åºåˆ—ï¼Œå› æ­¤æœ‰å‘æ— ç¯å›¾ä¹Ÿè¢«ç§°ä¸ºæ‹“æ‰‘å›¾

æ­¥éª¤ï¼š

1. åœ¨æœ‰å‘æ— ç¯å›¾ä¸­å¯»æ‰¾æ‰€æœ‰å…¥åº¦ä¸º 0 çš„ç‚¹ï¼ˆå³æ²¡æœ‰å…¶ä»–ç‚¹å¯ä»¥åœ¨è¯¥ç‚¹å‰ï¼‰ï¼Œå…¥é˜Ÿ
2. æšä¸¾è¿™äº›ç‚¹çš„å‡ºè¾¹ï¼Œåˆ æ‰è¿™æ¡è¾¹ï¼Œå‡å¦‚é˜Ÿåˆ—ä¸­çš„ç‚¹ A è¿å‘ Bï¼Œé‚£ä¹ˆåˆ é™¤`A->B`ï¼ŒB çš„å…¥åº¦å‡ä¸€
3. è‹¥ B çš„å…¥åº¦ä¸ºé›¶ï¼Œåˆ™å…¥é˜Ÿ<br>

åˆ¤æ–­ï¼š

å½“æ‰€æœ‰ç‚¹éƒ½è¿›å…¥é˜Ÿåˆ—ï¼Œåˆ™æ’åºå®Œæˆï¼Œé˜Ÿåˆ—ä¸­ç‚¹çš„é¡ºåºå°±æ˜¯æ‹“æ‰‘åºåˆ—ï¼Œè‹¥é˜Ÿåˆ—ä¸­ç‚¹æ•°å°‘äº nï¼Œåˆ™è¯´æ˜å›¾æœ‰ç¯ï¼Œæ— æ‹“æ‰‘åºåˆ—ã€‚

> å¯ä»¥çŸ¥é“å¦‚æœå›¾ä¸­å­˜åœ¨ç¯çš„è¯ï¼Œæ²¡æœ‰ä¸€ä¸ªç‚¹çš„å…¥åº¦ä¸ºé›¶ï¼Œå› æ­¤æœ‰ç¯å›¾æ— æ‹“æ‰‘åºåˆ—<br>
> æœ‰å‘æ— ç¯å›¾ä¸€å®šè‡³å°‘å­˜åœ¨ä¸€ä¸ªå…¥åº¦ä¸ºé›¶çš„ç‚¹

```cpp
#include <iostream>
#include <cstring>

using namespace std;
const int N = 1e5 + 10;
int h[N], e[N], ne[N], idx;
int q[N], d[N], hh = 0, tt = -1;

int n, m;

void add(int a, int b)
{
    e[idx] = b, ne[idx] = h[a], h[a] = idx ++;
}

bool topSort()
{
    for (int i = 1 ; i <= n ; i ++)
    {
        if (!d[i]) q[++ tt] = i;
    }

    while (hh <= tt)
    {
        int t = q[hh ++];

        for (int i = h[t] ; i != -1 ; i = ne[i])
        {
            int j = e[i];
            d[j] --;
            if (!d[j])
            {
                q[++ tt] = j;
            }
        }
    }
    if (tt == n - 1) return true;
    return false;
}

int main()
{
    cin >> n >> m;

    memset(h, -1, sizeof h);
    while (m --)
    {
        int a, b;
        cin >> a >> b;
        d[b] ++;
        add(a, b);
    }

    if (!topSort()) puts("-1");
    else
    {
        for (int i = 0 ; i < n; i ++)
        {
            if (i) cout << ' ';
            cout << q[i];
        }
    }

    return 0;
}
```
